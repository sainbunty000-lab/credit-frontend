<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Underwriting Suite</title>

<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

<style>
body{
margin:0;
font-family:Segoe UI;
background:#0f172a;
color:white;
}

.container{
padding:40px;
max-width:800px;
margin:auto;
}

.card{
background:#1e293b;
padding:20px;
border-radius:10px;
margin-bottom:20px;
}

button{
background:#38bdf8;
border:none;
padding:10px 15px;
border-radius:6px;
cursor:pointer;
font-weight:bold;
}

.green{color:#22c55e;}
.orange{color:#facc15;}
.red{color:#ef4444;}
</style>
</head>
<body>

<div id="root"></div>

<script>

const API_URL="https://credit-backend-yh78.onrender.com";

const e = React.createElement;

function App(){

const [bs,setBS] = React.useState(null);
const [pl,setPL] = React.useState(null);
const [bank,setBank] = React.useState(null);
const [result,setResult] = React.useState(null);
const [error,setError] = React.useState(null);

function formatCurrency(n){
return "â‚¹"+Number(n||0).toLocaleString("en-IN");
}

function riskColor(score){
if(score>=80) return "green";
if(score>=60) return "orange";
return "red";
}

async function run(){

setError(null);

if(!bs||!pl||!bank){
alert("Upload all documents");
return;
}

try{

const fd=new FormData();
fd.append("bs_file",bs);
fd.append("pl_file",pl);
fd.append("bank_file",bank);

const res=await fetch(API_URL+"/full-analysis",{method:"POST",body:fd});

if(!res.ok) throw new Error("Backend error");

const data=await res.json();
setResult(data);

}catch(err){
console.log(err);
setError("Error connecting to backend.");
}

}

return e("div",{className:"container"},

e("h2",null,"Enterprise Underwriting"),

e("div",{className:"card"},
e("p",null,"Balance Sheet"),
e("input",{type:"file",onChange:(ev)=>setBS(ev.target.files[0])}),
e("p",null,"P&L"),
e("input",{type:"file",onChange:(ev)=>setPL(ev.target.files[0])}),
e("p",null,"Bank Statement"),
e("input",{type:"file",onChange:(ev)=>setBank(ev.target.files[0])}),
e("br"),
e("br"),
e("button",{onClick:run},"Run Analysis")
),

error && e("div",{className:"card red"},error),

result && e("div",{className:"card"},
e("h3",null,"Results"),
e("p",null,"Bank Turnover: "+formatCurrency(result.Bank_Turnover)),
e("p",null,"Working Capital Limit: "+formatCurrency(result.Working_Capital_Limit)),
e("p",null,
"Risk Score: ",
e("span",{className:riskColor(result.Risk_Score)}," "+result.Risk_Score)
),
e("p",null,"Decision: "+result.Decision),
e("p",null,"Parsing Confidence: "+result.Parsing_Confidence+"%")
)

);

}

ReactDOM.createRoot(document.getElementById("root")).render(
React.createElement(App)
);

</script>

</body>
</html>
