<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>AI Underwriting Suite</title>

<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

<style>
body{
margin:0;
font-family:Segoe UI;
background:#0f172a;
color:white;
}

.container{
padding:40px;
max-width:900px;
margin:auto;
}

.card{
background:#1e293b;
padding:20px;
border-radius:10px;
margin-bottom:20px;
}

button{
background:#38bdf8;
border:none;
padding:10px 15px;
border-radius:6px;
cursor:pointer;
font-weight:bold;
}

.green{color:#22c55e;}
.orange{color:#facc15;}
.red{color:#ef4444;}
</style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">

const API_URL="https://credit-backend-yh78.onrender.com";

function App(){

const [bs,setBS]=React.useState(null);
const [pl,setPL]=React.useState(null);
const [bank,setBank]=React.useState(null);
const [result,setResult]=React.useState(null);
const [error,setError]=React.useState(null);

const formatCurrency=(n)=>"â‚¹"+Number(n||0).toLocaleString("en-IN");

const run=async()=>{

setError(null);

if(!bs||!pl||!bank){
alert("Upload all documents");
return;
}

try{
const fd=new FormData();
fd.append("bs_file",bs);
fd.append("pl_file",pl);
fd.append("bank_file",bank);

const res=await fetch(API_URL+"/full-analysis",{method:"POST",body:fd});

if(!res.ok){
throw new Error("Backend error");
}

const data=await res.json();
setResult(data);

}catch(err){
console.log(err);
setError("Something went wrong. Check backend or console.");
}
};

return(
<div className="container">

<h2>Enterprise Underwriting</h2>

<div className="card">
<p>Balance Sheet</p>
<input type="file" onChange={(e)=>setBS(e.target.files[0])}/>

<p>P&L</p>
<input type="file" onChange={(e)=>setPL(e.target.files[0])}/>

<p>Bank Statement</p>
<input type="file" onChange={(e)=>setBank(e.target.files[0])}/>

<br/><br/>
<button onClick={run}>Run Analysis</button>
</div>

{error && <div className="card red">{error}</div>}

{result && (
<div className="card">

<h3>Results</h3>

<p>Bank Turnover: {formatCurrency(result.Bank_Turnover)}</p>
<p>Working Capital Limit: {formatCurrency(result.Working_Capital_Limit)}</p>
<p>Risk Score:
<span className={
result.Risk_Score>=80?"green":
result.Risk_Score>=60?"orange":"red"
}>
 {result.Risk_Score}
</span>
</p>
<p>Decision: {result.Decision}</p>
<p>Parsing Confidence: {result.Parsing_Confidence}%</p>

</div>
)}

</div>
);
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);

</script>

</body>
</html>
